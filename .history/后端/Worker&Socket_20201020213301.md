# Web Worker
> Worker就是为JS创造多线程环境。JS是单线程的，处理一些复杂、耗时的操作，容易造成堵塞或者看起来失去响应。Worker可以创建一个线程，独立于JS运行的主线程，分担这些复杂耗时的任务。   
> Worker 线程一旦新建成功，就会始终运行，不会被主线程上的活动（比如用户点击按钮、提交表单）打断。这样有利于随时响应主线程的通信。但是，这也造成了 Worker 比较耗费资源，不应该过度使用，而且一旦使用完毕，就应该关闭.

## 使用
### 主线程
1. 主线程创建：
   ``` javascript
        worker=new Worker('worker.js')
   ```
2. 主线程接受子线程消息：
    ``` javascript
        worker.onmessage=function(event){
            console.log(event.data)
        }
   ```
3. 主线程与子线程通信：
      ``` javascript
      var data;
        worker.postMessage(data)
   ```
### 子线程
1. 子线程即worker.js内容。子线程的self为子线程的全局对象，即子线程自身。
2. 子线程接受主线程消息：  
    ``` javascript
        self.addEventListener('message', function (e) {   
           console.log(e.data);   
         }, false);
   ```
   或者  
   ``` javascript
        self.onmessage=function(event){
            console.log(event.data)
        }
   ```
3. 子线程发送消息给主线程：
     ``` javascript
        var data;
        postMessage(data)
   ```
## 注意点
+ worker的脚本文件必须和主线程的脚本文件同源。  
+ worker无法访问主线程所在网页的 DOM 对象，也无法使用document、window、parent这些对象。但是，Worker 线程可以navigator对象和location对象。
+ Worker 线程不能执行alert()方法和confirm()方法，但可以使用 XMLHttpRequest 对象发出 AJAX 请求。
+ Worker 线程无法读取本地文件，即不能打开本机的文件系统（file://），它所加载的脚本，必须来自网络。
